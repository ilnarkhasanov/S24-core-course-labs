# Secret creation

```
kubectl create secret generic db-user-pass --from-literal=username=admin --from-literal=password='S!B\*d$zDsb='
```

# Secret verification

```
$ kubectl get secret

NAME                               TYPE                 DATA   AGE
db-user-pass                       Opaque               2      2m6s
sh.helm.release.v1.helm-hooks.v1   helm.sh/release.v1   1      5d3h
```

```
$ kubectl describe secret db-user-pass

Name:         db-user-pass
Namespace:    default
Labels:       <none>
Annotations:  <none>

Type:  Opaque

Data
====
username:  5 bytes
password:  12 bytes
```

# Secret decoding

```
$ kubectl get secret db-user-pass -o jsonpath='{.data}'

{"password":"UyFCXCpkJHpEc2I9","username":"YWRtaW4="}
```

# Password inside of pod

```
$ kubectl exec app-python-56fd7d5c9-sg5dn -- printenv | grep MY_PAS
SWORD

MY_PASSWORD=secret1234
```

# Check Vault secret

```
$ kubectl exec -it app-python-598db6c7df-jq684 -- sh

Defaulted container "app-python" out of: app-python, vault-agent, vault-agent-init (init)
/code $ cd /vault/secrets/
/vault/secrets $ cat database-config.txt 
data: map[password:db-secret-password username:db-readonly-username]
metadata: map[created_time:2024-04-16T15:00:37.193257007Z custom_metadata:<nil> deletion_time: destroyed:false version:1]
```

# After injection

```
$ kubectl exec -it app-python-695f9cddfc-vc2xp -- cat /vault/secrets/database-config.txt

Defaulted container "app-python" out of: app-python, vault-agent, vault-agent-init (init)
postgresql://db-readonly-username:db-secret-password@postgres:5432/wizard
```

# Environment variables

```
$ kubectl describe deployment.app app-python | grep -A 3 Environment

    Environment:
      MY_PASSWORD:  <set to the key 'password' in secret 'credentials'>  Optional: false
      HELLO:        world
    Mounts:         <none>
```
